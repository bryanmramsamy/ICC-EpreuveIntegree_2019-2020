{% load i18n registration_extra %}


<table class="table table-striped table-hover">
  <thead>
    <tr class="d-flex">
      <th class="col-7">
        {% include 'logo/module.html' %} {% trans 'Module' %}
      </th>
      <th class="col-5">
        {% trans 'Status' %}
      </th>
    </tr>
  </thead>
  <tbody>
    {% for related_module in module_list_queryset %}
      <tr class="d-flex">
        <td class="col-7">
          <a href="{{ related_module.get_absolute_url }}" class="text-reset">
            <span class="h5">
              {{ related_module.title }}
            </span>
            <span class="small text-muted">
              {{ related_module.reference }}
            </span>
          </a>
        </td>
        <td class="col-5">
          {% if request.user|is_student %}
            {% if request.user|module_already_validated_by_user:related_module %}
              <span class="text-success">
                {% include 'logo/check_valid.html' %} {% trans 'Module already completed' %}
              </span>
            {% elif related_module.prerequisites.all.count == 0%}
              <span class="text-info">
                {% include 'logo/check_info.html' %} {% trans 'No prerequisite needed' %}
              </span>
            {% elif request.user|all_prerequisites_validated_by_user:related_module %}
              <span class="text-warning">
                {% include 'logo/check_ready.html' %} {% trans 'Prerequisites completed, not module itself' %}
              </span>
            {% else %}
              <span class="text-danger">
                {% include 'logo/check_invalid.html' %} {% trans 'Prerequisites missing' %}
              </span>
            {% endif %}
          {% else %}
            <span class="text-info">
              {% include 'logo/check_info.html' %}
              {% blocktrans count nb_prerequisites=related_module.prerequisites.all.count %}
                This module has only one prerequisite
              {% plural %}
                This module has {{ nb_prerequisites }} prerequisites
              {% endblocktrans %}
            </span>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="2" class="h5 text-center text-info">
          {% include 'logo/check_info.html' %} {% trans 'No module found' %}
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>


